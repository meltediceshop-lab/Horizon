{% comment %}
  Header dinámico estilo Juguettos con Búsqueda Central
{% endcomment %}

<header class="custom-header" style="background-color: {{ section.settings.bg_color }};">
  <div class="header-container">
    
    <div class="header-item header-logo">
      <a href="/">
        {% if section.settings.logo != blank %}
          <img src="{{ section.settings.logo | image_url: width: 250 }}" 
               alt="{{ shop.name }}" 
               style="max-width: {{ section.settings.logo_width }}px;">
        {% else %}
          <span class="shop-name-text" style="color: {{ section.settings.text_color }};">{{ shop.name }}</span>
        {% endif %}
      </a>
    </div>

    <div class="header-item header-search">
      <form action="/search" method="get" role="search" class="search-bar-form">
        <input 
          type="text" 
          name="q" 
          class="search-bar-input" 
          placeholder="{{ section.settings.search_placeholder }}" 
          aria-label="{{ section.settings.search_placeholder }}"
        >
        <button type="submit" class="search-bar-submit">
          <svg aria-hidden="true" focusable="false" role="presentation" class="icon-search" viewBox="0 0 20 20">
            <path fill="currentColor" d="M18.88 17.52l-4.91-4.91a7.41 7.41 0 10-1.36 1.36l4.91 4.91a.96.96 0 101.36-1.36zM3.86 8.41a4.55 4.55 0 114.55 4.55 4.55 4.55 0 01-4.55-4.55z"></path>
          </svg>
        </button>
      </form>
    </div>

    <div class="header-item header-icons" style="color: {{ section.settings.text_color }};">
      {% for block in section.blocks %}
        <a href="{{ block.settings.link }}" class="header-icon-link" {{ block.shopify_attributes }}>
          <div class="icon-svg-container">
            {{ block.settings.custom_icon_svg }}
            {% if block.type == 'cart_icon' %}
              <span class="cart-badge">{{ cart.item_count }}</span>
            {% endif %}
          </div>
          <span class="icon-text-label">{{ block.settings.label }}</span>
        </a>
      {% endfor %}
    </div>

  </div>
</header>

<style>
  /* Estilos Generales */
  .custom-header {
    width: 100%;
    padding: 10px 0;
    border-bottom: 1px solid rgba(255,255,255,0.1);
  }
  .header-container {
    display: grid;
    grid-template-columns: 200px 1fr auto; /* Logo fijo, Búsqueda flexible, Iconos auto */
    align-items: center;
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 20px;
    gap: 30px;
  }

  /* Logo */
  .header-logo img { display: block; height: auto; }
  .shop-name-text { font-size: 24px; font-weight: bold; text-decoration: none; }

  /* Barra de Búsqueda Estilo Pill */
  .header-search {
    width: 100%;
    max-width: 700px;
    margin: 0 auto;
  }
  .search-bar-form {
    display: flex;
    background: #FFFFFF;
    border-radius: 50px; /* Hace la barra redondeada como Juguettos */
    padding: 2px 15px;
    align-items: center;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }
  .search-bar-input {
    flex-grow: 1;
    border: none;
    padding: 10px 15px;
    font-size: 16px;
    outline: none;
    border-radius: 50px 0 0 50px;
    color: #333;
  }
  .search-bar-submit {
    background: none;
    border: none;
    cursor: pointer;
    padding: 5px;
    color: {{ section.settings.bg_color }}; /* El icono de lupa toma el color del fondo del header */
    display: flex;
    align-items: center;
  }
  .icon-search { width: 22px; height: 22px; }

  /* Iconos Dinámicos */
  .header-icons {
    display: flex;
    gap: 20px;
    align-items: flex-end;
  }
  .header-icon-link {
    text-decoration: none;
    color: inherit;
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: opacity 0.2s;
  }
  .header-icon-link:hover { opacity: 0.8; }
  
  .icon-svg-container {
    width: 28px;
    height: 28px;
    position: relative;
    margin-bottom: 4px;
  }
  .icon-svg-container svg { width: 100%; height: 100%; fill: currentColor; }
  
  .icon-text-label {
    font-size: 10px;
    font-weight: 700;
    text-transform: uppercase;
    white-space: nowrap;
  }

  /* Badge del Carrito */
  .cart-badge {
    position: absolute;
    top: -8px;
    right: -10px;
    background: #e30613; /* Rojo Juguettos */
    color: white;
    font-size: 10px;
    padding: 2px 6px;
    border-radius: 10px;
    font-weight: bold;
  }

  /* Responsive para Móvil */
  @media (max-width: 990px) {
    .header-container {
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }
    .header-search {
      grid-column: span 2;
      order: 3;
    }
  }
</style>

{% schema %}
{
  "name": "Header Juguettos PRO",
  "settings": [
    {
      "type": "color",
      "id": "bg_color",
      "label": "Color de fondo (Header)",
      "default": "#002266"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Color de iconos/texto",
      "default": "#ffffff"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo de la tienda"
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 50,
      "max": 250,
      "step": 10,
      "unit": "px",
      "label": "Ancho del logo",
      "default": 180
    },
    {
      "type": "text",
      "id": "search_placeholder",
      "label": "Texto de la barra de búsqueda",
      "default": "Buscar productos..."
    }
  ],
  "blocks": [
    {
      "type": "icon_link",
      "name": "Icono Personalizado",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Texto del icono",
          "default": "Tiendas"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Enlace"
        },
        {
          "type": "html",
          "id": "custom_icon_svg",
          "label": "Código SVG del icono"
        }
      ]
    },
    {
      "type": "cart_icon",
      "name": "Icono de Carrito",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Etiqueta",
          "default": "Mi Cesta"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Enlace al carrito",
          "default": "/cart"
        },
        {
          "type": "html",
          "id": "custom_icon_svg",
          "label": "Código SVG del carrito"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Header Personalizado",
      "blocks": [
        { "type": "icon_link", "settings": { "label": "Tiendas" } },
        { "type": "icon_link", "settings": { "label": "Favoritos" } },
        { "type": "cart_icon" }
      ]
    }
  ]
}
{% endschema %}