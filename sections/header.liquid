{% liquid
  # Estructura simplificada: Logo arriba, búsqueda abajo
  assign order = 'logo,contact,search'
  
  assign rows = 'top' | split: ','
  assign search_style = 'none'

  if section.settings.show_search
    assign search_style = 'inline'
  endif

  capture logo
    echo '<div class="header__logo-wrapper">'
    content_for 'block', type: '_header-logo', id: 'header-logo'
    echo '</div>'
  endcapture

  capture contact
    echo '<div class="header__contact-info text-sm text-gray-600 mt-1">'
    echo 'CONTACTA EN PEDIDOS@JUGUETTOS.ES SI TIENES ALGÚN PROBLEMA'
    echo '</div>'
  endcapture

  # Búsqueda personalizada y larga
  capture search
    echo '<div class="header__search-container w-full max-w-3xl mx-auto mt-4">'
    echo '<form action="' | append: routes.search_url | append: '" method="get" role="search" class="search-form relative">'
    echo '<input type="hidden" name="type" value="product,article,page">'
    echo '<input 
      type="search"
      name="q"
      placeholder="Buscar..."
      value="'
    echo search.terms | escape
    echo '"
      class="search__input w-full py-3 px-6 border-2 border-gray-300 rounded-full text-base focus:outline-none focus:border-black focus:ring-2 focus:ring-black/10"
      aria-label="'
    echo 'general.search.placeholder' | t
    echo '"
    />'
    echo '<button type="submit" class="search__button absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-black">'
    echo '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">'
    echo '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>'
    echo '</svg>'
    echo '<span class="sr-only">'
    echo 'general.search.search' | t
    echo '</span>'
    echo '</button>'
    echo '</form>'
    echo '</div>'
  endcapture

  assign class = 'header header--simple'

  # Estilos CSS personalizados
  capture custom_styles
    echo '<style>'
    echo '.header--simple {'
    echo '  padding: 1.5rem 0;'
    echo '}'
    echo '.header__logo-wrapper {'
    echo '  display: flex;'
    echo '  flex-direction: column;'
    echo '  align-items: flex-start;'
    echo '}'
    echo '.header__contact-info {'
    echo '  font-size: 0.875rem;'
    echo '  color: #6b7280;'
    echo '  margin-top: 0.25rem;'
    echo '  font-family: inherit;'
    echo '}'
    echo '.header__search-container {'
    echo '  margin-top: 1.5rem;'
    echo '}'
    echo '.search__input {'
    echo '  width: 100%;'
    echo '  max-width: 800px;'
    echo '  height: 50px;'
    echo '  border-radius: 25px !important;'
    echo '  border: 2px solid #e5e7eb !important;'
    echo '  padding: 0 1.5rem !important;'
    echo '  font-size: 1rem !important;'
    echo '  background: white !important;'
    echo '}'
    echo '.search__input:focus {'
    echo '  border-color: #000 !important;'
    echo '  box-shadow: 0 0 0 3px rgba(0,0,0,0.1) !important;'
    echo '  outline: none !important;'
    echo '}'
    echo '.search__button {'
    echo '  right: 1rem !important;'
    echo '}'
    echo '.header__row--top .header__columns {'
    echo '  display: flex;'
    echo '  flex-direction: column;'
    echo '  align-items: center;'
    echo '}'
    echo '.header__column {'
    echo '  width: 100%;'
    echo '  display: flex;'
    echo '  flex-direction: column;'
    echo '  align-items: center;'
    echo '}'
    echo '.header__column--logo {'
    echo '  align-items: flex-start;'
    echo '  width: 100%;'
    echo '  padding-left: 2rem;'
    echo '}'
    echo '@media (max-width: 768px) {'
    echo '  .header--simple {'
    echo '    padding: 1rem 0;'
    echo '  }'
    echo '  .header__contact-info {'
    echo '    font-size: 0.75rem;'
    echo '    text-align: center;'
    echo '    padding: 0 1rem;'
    echo '  }'
    echo '  .header__column--logo {'
    echo '    align-items: center;'
    echo '    padding-left: 0;'
    echo '  }'
    echo '  .search__input {'
    echo '    height: 44px;'
    echo '    font-size: 0.875rem !important;'
    echo '  }'
    echo '}'
    echo '</style>'
  endcapture
%}

{{ custom_styles }}

<header-component
  id="header-component"
  class="{{ class }}"
  data-theme-color="rgb({{ section.settings.color_scheme_top.settings.background.rgb }})"
  {% if section.settings.enable_sticky_header == 'always' %}sticky="always"{% endif %}
>
  {% for row in rows %}
    {% liquid
      assign scheme = 'color_scheme_' | append: row
      assign class = 'header__row header__row--[row] color-[row_scheme] section section--full-width-margin section--[section-width]' | replace: '[row]', row | replace: '[row_scheme]', section.settings[scheme] | replace: '[section-width]', section.settings.section_width
    %}

    <div class="{{ class | strip }}">
      <div class="header__columns spacing-style">
        <div class="header__column header__column--logo">
          {{ logo }}
          {{ contact }}
        </div>
        <div class="header__column header__column--search">
          {{ search }}
        </div>
      </div>
    </div>
  {% endfor %}
</header-component>

<script src="{{ 'header.js' | asset_url }}" type="module"></script>

{% schema %}
{
  "name": "t:names.header",
  "tag": "header",
  "class": "header-section",
  "settings": [
    {
      "type": "header",
      "content": "t:content.logo"
    },
    {
      "type": "select",
      "id": "logo_position",
      "label": "t:settings.position",
      "options": [
        { "value": "left", "label": "t:options.left" },
        { "value": "center", "label": "t:options.center" },
        { "value": "right", "label": "t:options.right" }
      ],
      "default": "left"
    },
    {
      "type": "header",
      "content": "t:content.search"
    },
    {
      "type": "checkbox",
      "id": "show_search",
      "label": "t:settings.search_icon",
      "default": true
    },
    {
      "type": "header",
      "content": "t:content.appearance"
    },
    {
      "type": "select",
      "id": "section_height",
      "label": "t:settings.height",
      "options": [
        { "value": "compact", "label": "t:options.compact" },
        { "value": "standard", "label": "t:options.standard" }
      ],
      "default": "standard"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme_top",
      "label": "t:settings.default",
      "default": "scheme-1"
    },
    {
      "type": "select",
      "id": "enable_sticky_header",
      "label": "t:settings.sticky_header",
      "options": [
        { "value": "always", "label": "t:options.always" },
        { "value": "never", "label": "t:options.never" }
      ],
      "default": "always"
    },
    {
      "type": "select",
      "id": "section_width",
      "label": "t:settings.section_width",
      "options": [
        { "value": "full-width", "label": "t:options.full_width" },
        { "value": "page-width", "label": "t:options.page_width" }
      ],
      "default": "page-width"
    }
  ],
  "presets": []
}
{% endschema %}